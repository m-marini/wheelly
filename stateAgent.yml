---
version: "0.5"
active: moveToAgent

configurations:
  ######################################
  # Explorer agent
  ######################################
  moveToAgent:
    class: org.mmarini.wheelly.engines.StateMachineAgent
    interval: 10
    commandInterval: 600
    reactionInterval: 300
    numRadarSectors: 24
    minRadarDistance: 0.3
    maxRadarDistance: 2.8
    radarWidth: 51
    radarHeight: 51
    radarGrid: 0.2
    radarReceptiveDistance: 0.28
    radarReceptiveAngle: 15
    radarPersistence: 300000
    radarCleanInterval: 30000
    flow:
      entry: start
      states:
        start:
          class: org.mmarini.wheelly.engines.HaltState
          timeout: 2000
        movingTo0:
          class: org.mmarini.wheelly.engines.MoveToState
          stopDistance: 0.4
          x: 0
          y: 0
        movingTo1:
          class: org.mmarini.wheelly.engines.MoveToState
          stopDistance: 0.4
          x: 0
          y: 2
      transitions:
        - from: start
          to: movingTo1
          trigger: timeout
        - from: movingTo1
          to: movingTo0
          trigger: completed
        - from: movingTo1
          to: start
          trigger: rearBlocked
        - from: movingTo1
          to: start
          trigger: frontBlocked
        - from: movingTo1
          to: start
          trigger: blocked
        - from: movingTo0
          to: movingTo1
          trigger: completed
        - from: movingTo0
          to: start
          trigger: rearBlocked
        - from: movingTo0
          to: start
          trigger: frontBlocked
        - from: movingTo0
          to: start
          trigger: blocked
  ######################################
  # Explorer agent
  ######################################
  explorerAgent:
    class: org.mmarini.wheelly.engines.StateMachineAgent
    interval: 10
    commandInterval: 600
    reactionInterval: 300
    numRadarSectors: 24
    minRadarDistance: 0.3
    maxRadarDistance: 2.8
    radarWidth: 51
    radarHeight: 51
    radarGrid: 0.2
    radarReceptiveDistance: 0.28
    radarReceptiveAngle: 15
    radarPersistence: 300000
    radarCleanInterval: 30000
    flow:
      entry: start
      states:
        start:
          class: org.mmarini.wheelly.engines.HaltState
          timeout: 2000
        exploring:
          class: org.mmarini.wheelly.engines.ExploringState
          stopDistance: 0.4
          turnDirectionRange: 30
        avoiding:
          class: org.mmarini.wheelly.engines.AvoidingState
          safeDistance: 0.4
      transitions:
        - from: start
          to: exploring
          trigger: timeout
        - from: exploring
          to: avoiding
          trigger: blocked
        - from: avoiding
          to: exploring
          trigger: completed
  ######################################
  # Idle agent
  ######################################
  idleAgent:
    class: org.mmarini.wheelly.engines.StateMachineAgent
    interval: 10
    commandInterval: 600
    reactionInterval: 300
    radarWidth: 25
    radarHeight: 25
    radarGrid: 0.6
    radarReceptiveDistance: 0.28
    radarReceptiveAngle: 15
    radarPersistence: 30000
    radarCleanInterval: 10000
    numRadarSectors: 24
    minRadarDistance: 0.3
    maxRadarDistance: 3
    flow:
      entry: idle
      states:
        idle:
          class: org.mmarini.wheelly.engines.HaltState
          scanInterval: 1000
          minSensorDir: -90
          maxSensorDir: 90
          sensorDirNumber: 9
        avoid:
          class: org.mmarini.wheelly.engines.AvoidingState
          safeDistance: 0.1
      transitions:
        - from: idle
          to: avoid
          trigger: frontBlocked
        - from: idle
          to: avoid
          trigger: rearBlocked
        - from: avoid
          to: idle
          trigger: completed
